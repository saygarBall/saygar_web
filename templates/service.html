<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>{{ category_name }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
    <div class="container mt-4">
        <h1 class="text-primary">{{ category_name }}</h1>

        <h2>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏¢‡πà‡∏≠‡∏¢</h2>
        <ul class="list-group">
            {% for id, name in subcategories %}
                <li class="list-group-item">
                    <a href="{{ url_for('service', category_id=id) }}" class="text-decoration-none">
                        <i class="fas fa-folder"></i> {{ name }}
                    </a>
                </li>
            {% endfor %}
        </ul>

        <h2 class="mt-4">‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</h2>
        <ul class="list-group">
            {% for id, title, updated_at in articles %}
                <li class="list-group-item">
                    <a href="{{ url_for('content.content', article_id=id) }}" class="text-decoration-none">
                        <i class="fas fa-file-alt"></i> {{ title }}
                    </a>
                    <br>
                    <small class="text-muted updated-time" data-time="{{ updated_at }}">üìÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</small>
                </li>
            {% endfor %}
        </ul>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll(".updated-time").forEach(function(el) {
            let rawTime = el.getAttribute("data-time");

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Timestamp (Unix Time) ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô String (YYYY-MM-DD HH:MM:SS)
            let timestamp;
            if (!isNaN(rawTime) && rawTime.length >= 10) {
                timestamp = parseInt(rawTime) * 1000; // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Unix Time ‚Üí ‡∏Ñ‡∏π‡∏ì 1000 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô milliseconds
            } else {
                timestamp = Date.parse(rawTime); // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö String ‚Üí ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Timestamp
            }

            if (!isNaN(timestamp)) {
                let dateObj = new Date(timestamp);

                let options = { 
                    year: "numeric", 
                    month: "long", 
                    day: "numeric",
                    hour: "2-digit", 
                    minute: "2-digit",
                    second: "2-digit",
                    hour12: false
                };

                let formattedDate = new Intl.DateTimeFormat("th-TH", options).format(dateObj);
                el.innerText = `üìÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${formattedDate}`;
            } else {
                el.innerText = "üìÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ";
            }
        });
    });
    </script>

</body>
</html>
